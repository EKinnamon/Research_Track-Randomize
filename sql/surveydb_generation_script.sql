CREATE TABLE [dbo].[Pages] (
    [Id] [int] NOT NULL IDENTITY,
    [SectionId] [int] NOT NULL,
    [Order] [int] NOT NULL,
    [Range] [int],
    [Text] [nvarchar](max),
    [True] [nvarchar](max),
    [False] [nvarchar](max),
    [Discriminator] [nvarchar](128) NOT NULL,
    CONSTRAINT [PK_dbo.Pages] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_SectionId] ON [dbo].[Pages]([SectionId])
CREATE TABLE [dbo].[Sections] (
    [Id] [int] NOT NULL IDENTITY,
    [SurveyId] [int] NOT NULL,
    [Name] [nvarchar](max),
    [Order] [int] NOT NULL,
    CONSTRAINT [PK_dbo.Sections] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_SurveyId] ON [dbo].[Sections]([SurveyId])
CREATE TABLE [dbo].[Surveys] (
    [Id] [int] NOT NULL IDENTITY,
    [Name] [nvarchar](max),
    [Version] [nvarchar](max),
    [IsActive] [bit] NOT NULL,
    CONSTRAINT [PK_dbo.Surveys] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[TestResponses] (
    [TestId] [uniqueidentifier] NOT NULL,
    [SectionId] [int] NOT NULL,
    [PageId] [int] NOT NULL,
    [Response] [nvarchar](max),
    [Created] [datetime] NOT NULL,
    [Modified] [datetime],
    CONSTRAINT [PK_dbo.TestResponses] PRIMARY KEY ([TestId], [SectionId], [PageId])
)
CREATE INDEX [IX_TestId] ON [dbo].[TestResponses]([TestId])
CREATE INDEX [IX_SectionId] ON [dbo].[TestResponses]([SectionId])
CREATE INDEX [IX_PageId] ON [dbo].[TestResponses]([PageId])
CREATE TABLE [dbo].[Tests] (
    [Id] [uniqueidentifier] NOT NULL,
    [UserId] [nvarchar](max),
    [SurveyId] [int] NOT NULL,
    [Started] [datetime] NOT NULL,
    [Modified] [datetime],
    [Completed] [datetime],
    CONSTRAINT [PK_dbo.Tests] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_SurveyId] ON [dbo].[Tests]([SurveyId])
ALTER TABLE [dbo].[Pages] ADD CONSTRAINT [FK_dbo.Pages_dbo.Sections_SectionId] FOREIGN KEY ([SectionId]) REFERENCES [dbo].[Sections] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[Sections] ADD CONSTRAINT [FK_dbo.Sections_dbo.Surveys_SurveyId] FOREIGN KEY ([SurveyId]) REFERENCES [dbo].[Surveys] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[TestResponses] ADD CONSTRAINT [FK_dbo.TestResponses_dbo.Pages_PageId] FOREIGN KEY ([PageId]) REFERENCES [dbo].[Pages] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[TestResponses] ADD CONSTRAINT [FK_dbo.TestResponses_dbo.Sections_SectionId] FOREIGN KEY ([SectionId]) REFERENCES [dbo].[Sections] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[TestResponses] ADD CONSTRAINT [FK_dbo.TestResponses_dbo.Tests_TestId] FOREIGN KEY ([TestId]) REFERENCES [dbo].[Tests] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[Tests] ADD CONSTRAINT [FK_dbo.Tests_dbo.Surveys_SurveyId] FOREIGN KEY ([SurveyId]) REFERENCES [dbo].[Surveys] ([Id]) ON DELETE CASCADE
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](150) NOT NULL,
    [ContextKey] [nvarchar](300) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
)
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'201807250649273_Initial', N'EKSurvey.Data.Migrations.Configuration',  0x1F8B0800000000000400ED5DDD6EE3B612BE2F70DE41D0555BA4767EBA8B3D81DD22EB246DD066B3274E7ACE5D404BB443543F5E890A1C147DB25E9C473AAF7048FD92142951962C6917C5028B35450E8733DF90C3D18CF67F7FFD77F6E3CE758C171884C8F7E6E6C9E4D834A067F936F2367333C2EBEFDE993FFEF08FAF6657B6BB337ECBFA9DD17E64A417CECD678CB7E7D369683D431784131759811FFA6B3CB17C770A6C7F7A7A7CFCCFE9C9C914121226A16518B3FBC8C3C885F10FF273E17B16DCE20838B7BE0D9D306D274F963155E3037061B805169C9B57BF2CA3E005BE4E2E0106A671E12040985842676D1AC0F37C0C3061F1FC31844B1CF8DE66B9250DC07978DD42D26F0D9C10A6AC9F17DD7557717C4A57312D0666A4AC28C4BEDB90E0C9592A96A9387C2FE19AB9D86291BA5B07EEE8B263E9CDCDDB17EB67EC3A442A44B7A6214E79BE7002DA9BC8F235C4D09DFC1BAE2664CC841B7764F04F8F724CBC999C4EDE4E8E8F8C45E4E02880730F463800CE91F1315A39C8FA05BE3EF8BF436F7E76B25A9FBD7BF316D8676FBF87676F4C63CA327E4590815F19BE3F820DAC623707C4C20FE02401D024A6826038A1A38F0C599F8275827AFAA79E752F721C02B955489E5A786EE22082ACD409FBA42FD7409A3E06FE1606F8F51EAED325DDD8FCA249A7A938301FC68C49167CE3E1B353D3F84098012B07E6A06684B3C4649D3F410F060043FB23C018061EA50163E9966617E65A428B92A99FB29ACC5D60C3A021890FE0056DE245C879328D7BE8C4CFC367B44D0C7F923E7BA2CA0E4DE33AF0DD7BDF2906250F9E1E40B0819830E4CB9E2EFD28B0048666D3028E9520CDB9DB17A729816EA1FA254233164E5B64D2BF330AD986780B76BF426F839FC956097604456807EDAC25A5FAE8217236C2D4F2FB847F0AEDFDC19FC15B0EFECC34B4AD3156839C9FF8D1534A9FE7887F543648E1793B934C59DCDB22E3677F1BE4184C2995F6C1E7B9092F08F45EF205BDF7092E81D7FED85298AEBEA994CC57614A7B99CA7500E103DCE17F45306C778C89943A76BDDE8310A610A0F24B5CC36AF791FAAEED5CC88C420F6BA90427956B6E017488E0D15762541B0BF7C0DBC0F640E0C80C2DB998992627B1FE2143A56251CDB4C3184F6768797148EB66AFD596E803197A4DC9B5C76089D4E0728DC572E033EC3A193390F688A0EF61B82547520B6B60A90CEE805166CA4E98B42B736FD6E84DF1B28F7797319448F2A708D98DEF3F1D5DF0B315B4A151A0E5C076B108207570B3792EC98F07447DD7860C1300A23592116A729793FA832CEE9F925E8547587A58F209CB3D1A5FEB2A822C1CF5BCA382BFEC7659C962D6A9299794483D8B492F057FF4473573718F565E75C2409B3D70F0BDAFDDE573AFADE931844141E260BB41377124E2B605BDEE29E29E1647F9A51C7410C9498C247DCE1BD25376FF949850F6AC89F15C84A16FA198017E2B4AC35AFC62AE3CDBA88C71154E59BE51DD1213415B621464F6B979628AE0BFF32E2115A57161252F701620B4805D96245981ADC74E1EDE126FAC3C2FDF96A6200608031A7E01CE8268849834F270D95A9167A12D70AA44210CD23472BACA9CBCF8E4126EA1478343556BD699B7CA5B9AE6B308C2AF13CD6CCA40A9066142F445A95455288641596A24FD804C1545AD457D5748930BA40FACC997AE85B67CC31F046C65D74EA5DE0A3FAF50307FCFAAD3721571CD4DAA532CEF853A25EB3DE04EA9139DB9E5F7BC2170976D0B5AE828B9F01DA34FF4FE7B3EB4DB63505840DF3014F4F3399CB8AC435985919277C943AF29E44487B4DF837B6FA0096CF7842F41F69FDBD11AE3436BFFE143001D6F6E5CF4A006BEE3409B94F5BEF73456273A732B63B3DDE32EB9B79231988C800107FDCB156D8F5F9A94C23D8F214C233EA134612CA1BB84984FF428AEC9CA779D92C1C59BE4D2F8FC4CAD2311AF484A21DD2B6B08B00A9591E1ED4B83988A486930A3B99248B2F418A68F347F4604525DA8216798157E098E751102864ACAA768E8FCDA74D62DE61648565E7501D6BA02B3ABCF7053B578C5CD5543887B4840124D2FCBA0E65EA67933631620C0BF421AEABBD801E0208FDED7C8437A5FD0BF31B4978A7847381C50F238A75C2452AFB5D66F150450BF70D153ADB7AFB6504836D21A1C949D2A4DB7AA3D023847AA4E9E15C2C802CFF9019E3F9B4D932283B46136555423CC6EC1768BBC0D539D90B618CBA43461F1DDB279E2BE9BD0985ADCFE2BBA1BF94CD80FC88E203CA52F026C788D8210D3AA8815A027EBC2764BDD44774571F866B3B11E49595FD9919CF5A6FFCED2E8E8BFEFD65F73C51AB10BF38DC4AF4B095C9395B9D4318C3312853DB03CCCA0D521C00181E4FDD3C27722D753FBA7EAD1CC15992552717356D34A1380593A695399C66C2A48A1E4D19604DE4423BC224AF97EA3D10901A68DE2BBDD6FC089A02C3591A57389422B402EF200616F70B1E6A986E31567910D395E31F21988A391A574749A59C812489BF4F421645B8E572942A2E3B8B592E42FB2E393163D9D88399DE3554A395772E47A89133338BD485235AA28A4C98D2C896B5982854AB792ECD25ED59B3D2F9C2C2D17ACE28AAE6DC0F2BB9C064294230FE481E5D164CE0153C698D59492D214964AD2324E0F6E5F68A4F7C216C8905E6D7580A11878185CB4D7665E45C412C91BF5E9145542DC6AF2D6D16083BF73B73867D8906D739C540F571FE2496C9F3FC6E5F17E35952EEF73D98B7C9690EAE5BE9A4A11FBE6BC464544BC8A529ED1CC12CA1BF5E914D9872CA1A27554786E8BE33DF1DBD72E97A5BFB214B2B621CED03CC3952394351E12634AD41739AF1CEE8BE69EF15A0A2D8A5DF2D9F310A3104A9CA561BDFAAF9F94E27C4917D320427A41761CE34B3ED0911CED9F9C8583C87A8B0EB7C0436B02E82431DC3C3D3E7E277C45653C5F349986A1ED48C2A2E2D741785DF590D98EA8446B0BA7DB16E5C4B3945E28DF7836DCCDCD3FE251E7C6CD7F9EF2814746EC9D9E1BC7C69FEDBED6114FDDB49287ADB21408E8A4E4B35587DE0B08AC67107CED82DD378D09316576AD0871A574AD2809174B9E2257DE7072FAAEB3E25469BADF676B1E42C586B675A4E35A194772D5E800080DADACE9D72EBE0C5577266DE1BB11AD6889DF8658A1CE94A7BE207D1125AA91873E4510C56820DE5EA065B6098956463BF081CA57C7EACE9D8C6A35B15852DB0AF642D9AC4D7EE02E4ADC64845A169EF7BFFB9591DDAADAB195A2063D1F8542C89E512241AD5818D90E6E2DCB1307AC484C5E61F55A81D847D6B0E225E4F84A1E9A15190E5854A88FD44EAB087BAC50FDEC6A192ACB04B50CFB4060E153B8F7AE9DD80B36DA96DF615DC21756E637FCA93424807A3CA51A6368E8D34AA7406FE8932AC9586E5C1238F2334AF16A6ADC07546DB15DBFB56FE3D85FB435D9F7E63278B15C39495DD45FB9144E590997BCF82217BB954F349C5CE8E4C5328A22B9AA1A39197165C189BC82AEA2804E4A5D51DE51555D575B5C279BA8B20E433A9DB2FC4E45BE4CB697CA3C59795065A1098BAF22177294A5779252209D32431D918CA1B24E4B13153BBC2AD968B47573FB42B6CF65B72E89DB0FBAEC9653A4DF8CB4ECAD96D1836AAF41515B39C3841CEFCCFFC243DC8B106D0A123475DA4B005910CDFADC786B3FF32F048EB22E625C1762609353FF22C0680D2C4C1E5B300CE36FFBA5A9D957EE0ADA37DE5D84B711264B86EECAE19042FD94AAF9E3CA3D9EE7D9DD36DE5FBB58026113D128F29DF73E428E9DF32DC93F5791A00E50FA9A94EA12D3D7A59BD79CD207DFD324948A2FF7DB1EA0BB7508B1F0CE5B02FA8AB2396F8F21FC156E80F59A250AA989D42B8217FBEC12814D00DC30A5518C273F09866D77F7C3FF0105F7F8E68C6A0000 , N'6.2.0-61023')

